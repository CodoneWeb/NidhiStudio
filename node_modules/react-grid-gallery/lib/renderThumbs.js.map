{"version":3,"file":"renderThumbs.js","sources":["../src/renderThumbs.js"],"sourcesContent":["const calculateCutOff = (len, delta, items) => {\n  const cutoff = [];\n  let cutsum = 0;\n  for (var i in items) {\n    const item = items[i];\n    const fractOfLen = item.scaletwidth / len;\n    cutoff[i] = Math.floor(fractOfLen * delta);\n    cutsum += cutoff[i];\n  }\n\n  let stillToCutOff = delta - cutsum;\n  while (stillToCutOff > 0) {\n    for (i in cutoff) {\n      cutoff[i]++;\n      stillToCutOff--;\n      if (stillToCutOff < 0) break;\n    }\n  }\n  return cutoff;\n};\n\nconst buildImageRow = (data, { containerWidth, margin }) => {\n  const row = [];\n  let len = 0;\n  const imgMargin = 2 * margin;\n  while (data.items.length > 0 && len < containerWidth) {\n    var item = data.items.shift();\n    row.push(item);\n    len += item.scaletwidth + imgMargin;\n  }\n\n  const delta = len - containerWidth;\n  if (row.length > 0 && delta > 0) {\n    const cutoff = calculateCutOff(len, delta, row);\n    for (const i in row) {\n      const pixelsToRemove = cutoff[i];\n      item = row[i];\n      item.marginLeft = -Math.abs(Math.floor(pixelsToRemove / 2));\n      item.vwidth = item.scaletwidth - pixelsToRemove;\n    }\n  } else {\n    for (const j in row) {\n      item = row[j];\n      item.marginLeft = 0;\n      item.vwidth = item.scaletwidth;\n    }\n  }\n  return row;\n};\n\nconst renderThumbs = (\n  images,\n  { containerWidth, maxRows, rowHeight, margin }\n) => {\n  rowHeight = typeof rowHeight === \"undefined\" ? 180 : rowHeight;\n  margin = typeof margin === \"undefined\" ? 2 : margin;\n\n  if (!images) return [];\n  if (!containerWidth) return [];\n\n  let items = images.slice();\n  items = items.map((item) => ({\n    ...item,\n    scaletwidth: Math.floor(\n      rowHeight * (item.thumbnailWidth / item.thumbnailHeight)\n    ),\n  }));\n  const data = { items };\n\n  const thumbs = [];\n  const rows = [];\n  while (data.items.length > 0) {\n    rows.push(buildImageRow(data, { containerWidth, margin }));\n  }\n\n  for (const r in rows) {\n    for (const i in rows[r]) {\n      const item = { ...rows[r][i], rowIndex: parseInt(r) };\n      if (maxRows) {\n        if (r < maxRows) {\n          thumbs.push(item);\n        }\n      } else {\n        thumbs.push(item);\n      }\n    }\n  }\n  return thumbs;\n};\n\nexport default renderThumbs;\n"],"names":["calculateCutOff","len","delta","items","cutoff","cutsum","i","item","fractOfLen","scaletwidth","Math","floor","stillToCutOff","buildImageRow","data","containerWidth","margin","row","imgMargin","length","shift","push","pixelsToRemove","marginLeft","abs","vwidth","j","renderThumbs","images","maxRows","rowHeight","slice","map","thumbnailWidth","thumbnailHeight","thumbs","rows","r","rowIndex","parseInt"],"mappings":"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"}